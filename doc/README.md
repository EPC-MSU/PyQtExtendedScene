# PyQtExtendedScene

## Описание модуля

* **doc** - папка с описанием модуля.
* **examples** - папка с примерами.

* **PyQtExtendedScene** - папка с модулем.
    * **basecomponent.py** - файл с базовым классом **BaseComponent** для компонентов.
    * **componentgroup.py** - файл с классом **ComponentGroup** для составных компонентов.
    * **extendedscene.py** - файл с основным виджетом/сценой **ExtendedScene** для рисования компонентов.
    * **pointcomponent.py** - файл с классом **PointComponent** компонента, который представляет собой точку.
    * **rectcomponent.py** - файл с классом **RectComponent** компонента, который представляет собой прямоугольник.
    * **scenemode.py** - файл с перечислением режимов **SceneMode**, в которых может находиться сцена.
    * **sender.py** - файл с вспомогательным классом для отправки Qt-сигналов. 
    * **utils.py** - файл с мелкими функциями.
* **scripts** - папка со скриптами для выпуска релиза.
* **tests** - тесты.

## Типы компонентов
В **PyQtExtendedScene** есть компоненты следующих типов:
* **PointComponent** - точка;
* **RectComponent** - прямоугольник;
* **ComponentGroup** - составной компонент.

Составной компонент может включать в себя прямоугольники и точки.

Компонентам можно задать следующие атрибуты, которые влияют на поведение компонентов в обычном режиме (о режимах работы написано ниже):

* **draggable** - компонент можно перемещать в обычном режиме;
* **selectable** - компонент можно выбирать в обычном режиме;
* **unique_selection** - компонент может быть выбран только единолично.

## Режимы
Виджет **ExtendedScene** может находиться в одном из режимов:
* **NORMAL** - обычный режим;
* **EDIT** - режим редактирования;
* **EDIT_GROUP** - режим редактирования составного компонента.

#### Общий функционал для всех режимов

Во всех режимах можно:

- Перетаскивать сцену зажатой **ЛЕВОЙ** кнопкой мышки.
- Зумировать сцену колесиком мышки.
- Выделять объект кликом **ЛЕВОЙ** кнопки мышки по объекту.
- Выделять несколько объектов кликом **ЛЕВОЙ** кнопки мышки по объектам с зажатой клавишей **Ctrl**.
- Копировать выделанные объекты с помощью быстрых клавиш **Ctrl + C**.
- Вырезать выделенные объекты с помощью быстрых клавиш **Ctrl + Z**.
- Вставлять скопированные/вырезанные объекты с помощью быстрых клавиш **Ctrl + V**.
- Удалять выделенные объекты с помощью клавишы **Delete**.

#### Обычный режим
По умолчанию сцена находится в обычном режиме. Для перехода в обычный режим нужно вызвать метод:

```python
scene.set_scene_mode(SceneMode.NORMAL)
```

В обычном режиме можно:
* Выделять объекты движением мышки с зажатой **ПРАВОЙ** кнопкой мышки.

По умолчанию все созданные объекты можно выделять и перемещать. Чтобы запретить выделение объекта в обычном режиме, при создании объекта нужно передать аргумент:

```python
component = Component(selectable=False)
```

Чтобы запретить перемещение объекта в обычном режиме, при создании объекта нужно передать аргумент:

```python
component = Component(draggable=False)
```

#### Режим редактирования
Для перехода в режим редактирования нужно вызвать метод:

```python
scene.set_scene_mode(SceneMode.EDIT)
```

В режиме редактирования можно:
* Рисовать точку кликом **ПРАВОЙ** кнопки мышки и нажатой клавише Shift.
* Рисовать прямоугольник зажатой **ПРАВОЙ** кнопкой мышки.
* Перетаскивать точку, прямоугольник, составной компонент зажатой **ЛЕВОЙ** кнопкой мышки при наведении мышки внутрь соответствующего объекта. Если перетаскиваемые точка или прямоугольник находятся в составном компоненте, то составной компонент перетаскивается целиком.
* Изменять размеры прямоугольника, который не находится в составном компоненте. Для этого нужно навести мышку на границу прямоугольника и зажать **ЛЕВУЮ** кнопку мышки.

В режиме редактирования все объекты, которые не являются частью составного компонента, могут выделяться и перемещаться.

#### Режим редактирования составного компонента

Для перехода в режим редактирования составного компонента нужно выделить составной компонент и вызвать метод:

```python
scene.set_scene_mode(SceneMode.EDIT_GROUP)
```

В режиме редактирования составного компонента можно:

* Перетаскивать точку, прямоугольник, находящиеся внутри составного компонента. Для этого нужно навести мышку внутрь точки/прямоугольника и зажать **ЛЕВУЮ** кнопку мышки.
* Изменять размеры прямоугольника, который находится внутри составного компонента. Для этого нужно навести мышку на границу прямоугольника и зажать **ЛЕВУЮ** кнопку мышки.

В этом режиме можно работать только с объектами, которые входят в составной компонент.

Если при переходе в режим редактирования составного компонента не был выделен составной компонент либо было выделено больше одного составного компонента, то будет создан новый (пустой) составной компонент. Все созданные прямоугольники/точки будут включены в состав нового составного компонента.